import{j as t}from"./jsx-runtime-FsUICBgo.js";import{d as c}from"./index-777x7qAF.js";import{r as s}from"./index-RfLt4OUa.js";import{S as fe,C as Se}from"./index-DqzOLr2B.js";import{L as Q}from"./index-RqkF5WTj.js";import{w as xe,F as ye,o as Ce,S as be,b as Ae,u as je,D as G,a as we}from"./chunk-WFFRPTHA-XxQL4zvM.js";import{v as _e}from"./v4-yQnnJER4.js";import{s as M}from"./Button-I6r7vMZn.js";import{S as ve}from"./SearchResults-CXgGxh_l.js";import{S as J,D as Te,c as De}from"./storybookUtils-P7YVKdto.js";import"./callBound-4MCeDK1M.js";import"./pickBy-llkn_6s3.js";import"./isPlainObject-g73re4jY.js";import"./index-xck8ovCi.js";import"./preview-errors-Ix78kkVy.js";import"./debounce-eWC8LGMf.js";import"./index-4QtD-hFu.js";import"./getPrototypeOf-A6qCQ9Q6.js";import"./index-tUYgphcS.js";import"./uniq-hAFl8ubt.js";import"./_baseUniq-2t0Y7xw1.js";import"./getDocumentTitle-VPNHYBn-.js";import"./useControllableState-zgv_Y9NL.js";import"./purify.es-29Q0w72t.js";import"./formatMessage-wl7oTduw.js";const Ie=(a,r)=>{const[n,l]=s.useState(a);return s.useEffect(()=>{const p=window.setTimeout(()=>{l(a)},r);return()=>{window.clearTimeout(p)}},[r,a]),n},E={placeholderText:"Search",closeButtonLabelText:"Clear search input"},Ee=({className:a,id:r,splitSearchQuerySelector:n=" ",completionsCount:l=5,showAutocomplete:p,minCharsToAutocomplete:g=0,spellingSuggestions:$,messages:Z=E,autocompleteDelay:ee=200,placeHolderText:$e,labelText:Le,closeButtonLabelText:Pe,onChange:L,...P})=>{const A={...E,...Z},f=s.useMemo(()=>r||`search-input__${_e()}`,[r]),m=`${M.prefix}--search-autocompletion`,te=[a,`${M.prefix}--search-input--discovery`],{searchResponseStore:{parameters:d},autocompletionStore:{data:B},componentSettings:j}=s.useContext(be),w={showAutocomplete:p??(j==null?void 0:j.autocomplete)??!0},{performSearch:oe,fetchAutocompletions:N,setAutocompletionOptions:F,setSearchParameters:S}=s.useContext(Ae),[u,_]=s.useState(d.naturalLanguageQuery||""),v=B&&B.completions||[],h=u.split(n).pop(),[se,re]=s.useState(!1),[ne,k]=s.useState(!1);let i=null;s.useEffect(()=>{_(d.naturalLanguageQuery||"")},[d.naturalLanguageQuery]);const ae=e=>{const o=e.currentTarget;_(o?o.value:"")},R=e=>{const o=u.split(n),D=o.pop(),I=v?v[e]:D;o.push(I||""),_(`${o.join(n)}${n}`);const O=document.getElementById(`${f}_input_field`);O!==null&&O.focus()},ce=je(e=>({...d,naturalLanguageQuery:e,offset:0,filter:""}),[d]),le=e=>o=>{o.key==="Enter"&&R(e)},ue=e=>()=>{R(e)},ie=e=>{oe(ce(e)),L&&L(e);const o=document.getElementById(`${f}_input_field`);o!==null&&o.blur()},T=Ie(u,ee);s.useEffect(()=>{S(e=>({...e,naturalLanguageQuery:T})),se?re(!1):N(T)},[T,N,S]),s.useEffect(()=>{F({updateAutocompletions:w.showAutocomplete,completionsCount:l,minCharsToAutocomplete:g,splitSearchQuerySelector:n})},[w.showAutocomplete,l,g,n,F]),s.useEffect(()=>{S(e=>({...e,spellingSuggestions:!!$}))},[S,$]);const pe=e=>{e.key==="Enter"&&ie(u)};s.useEffect(()=>function(){i&&clearTimeout(i)},[i]);const me=()=>{i&&clearTimeout(i),k(!0)},de=()=>{i=setTimeout(()=>{k(!1)},0)},he=h!==""&&w.showAutocomplete&&ne,ge=v.map((e,o)=>{const D=u.slice(0,u.length-h.length);if(e.startsWith(h)){const I=e.slice(h.length);return t.jsx(Q,{className:`${m}__wrapper`,children:t.jsxs(Q.Field,{role:"listitem",id:`autocompletion_${o}_field`,tabIndex:"0",className:`${m}__item`,onClick:ue(o),onKeyUp:le(o),children:[t.jsx("div",{className:`${m}__icon`,children:t.jsx(fe,{})}),t.jsxs("div",{className:`${m}__term`,children:[D,t.jsx("strong",{children:h}),I]})]})},`autocompletion_${o}`)}return null});return t.jsx("div",{className:te.join(" "),id:f,"data-testid":"search-input-test-id",onBlur:de,children:t.jsxs("div",{onFocus:me,children:[t.jsx(Se,{onKeyUp:pe,onChange:ae,value:u,id:`${f}_input_field`,labelText:P.labelText||A.placeholderText,placeholder:A.placeholderText,closeButtonLabelText:A.closeButtonLabelText,...P}),he&&t.jsx("div",{className:m,"data-testid":"completions-dropdown-test-id",children:ge})]})})},W=xe(Ee,ye("SearchInput"),Ce),C=()=>({className:c.text("Classname to pass in your own styling (className)",""),id:c.text("Html element ID (id)",""),splitSearchQuerySelector:c.text("String to split words on for autocompletion (splitSearchQuerySelector)"," "),spellingSuggestions:c.boolean("Fetch spelling suggestions (spellingSuggestions)",!0),completionsCount:c.number("Number of autocompletion results to show (completionsCount)",5),showAutocomplete:c.boolean("Show dropdown of autocomplete suggestions (showAutocomplete)",!0),minCharsToAutocomplete:c.number("Minimum characters in last word before showing autocomplete suggestions (minCharsToAutocomplete)",1),messages:c.object("Default messages for the component's text strings",E),autocompleteDelay:c.number("Milliseconds to delay the autocomplete API requests (autocompleteDelay)",200)});let b=[];const X=(a,r)=>{const n=[];for(let l=0;l<a;l++){const p=`autocomplete-suggestion-${l+1}`,g=r+p.slice(r.length);n.push(g)}return n};class We extends Te{getAutocompletion(r){return we("getAutocompletion")(r),b=X(C().completionsCount||0,r.prefix||""),De({completions:b})}}const Y=()=>({searchClient:new We,projectId:c.text("Project ID","project-id"),overrideAutocompletionResults:{completions:b}}),at={title:"SearchInput",parameters:{component:W}},x={render:()=>(b=X(C().completionsCount,""),t.jsx(J,{children:t.jsx(G,{...Y(),children:t.jsx(W,{...C()})})})),name:"default"},y={render:()=>{const a={...Y(),overrideQueryParameters:{naturalLanguageQuery:"Waston"},overrideSearchResults:{suggested_query:"Watson"}};return t.jsx(J,{children:t.jsxs(G,{...a,children:[t.jsx(W,{...C()}),t.jsx(ve,{})]})})},name:"with spelling suggestions"};var V,H,K;x.parameters={...x.parameters,docs:{...(V=x.parameters)==null?void 0:V.docs,source:{originalSource:`{
  render: () => {
    autocompletions = generateCompletionsArray(props().completionsCount, '');
    return <StoryWrapper>
        <DiscoverySearch {...discoverySearchProps()}>
          <SearchInput {...props()} />
        </DiscoverySearch>
      </StoryWrapper>;
  },
  name: 'default'
}`,...(K=(H=x.parameters)==null?void 0:H.docs)==null?void 0:K.source}}};var U,q,z;y.parameters={...y.parameters,docs:{...(U=y.parameters)==null?void 0:U.docs,source:{originalSource:`{
  render: () => {
    const spellingSuggestionProps = {
      ...discoverySearchProps(),
      overrideQueryParameters: {
        naturalLanguageQuery: 'Waston'
      },
      overrideSearchResults: {
        suggested_query: 'Watson'
      }
    };
    return <StoryWrapper>
        <DiscoverySearch {...spellingSuggestionProps}>
          <SearchInput {...props()} />
          <SearchResults />
        </DiscoverySearch>
      </StoryWrapper>;
  },
  name: 'with spelling suggestions'
}`,...(z=(q=y.parameters)==null?void 0:q.docs)==null?void 0:z.source}}};const ct=["Default","WithSpellingSuggestions"];export{x as Default,y as WithSpellingSuggestions,ct as __namedExportsOrder,at as default};
